<% cache cacheable_preview_parts_for(card) do %>
  <%= card_article_tag card, class: "card", draggable: true, data: { id: card.id, drag_and_drop_target: "item" } do %>
    <div class="flex gap">
      <div class="flex flex-column flex-item-grow">
        <header class="card__header">
          <%= render "cards/display/preview/collection", card: card %>
          <%= render "cards/display/preview/tags", card: card %>
        </header>

        <div class="card__body justify-space-between">
          <div class="card__content">
            <h1 class="card__title overflow-line-clamp">
              <%= card.title %>
            </h1>

            <%= link_to collection_card_path(card.collection, card), draggable: false, class: "card__link", title: card_title_tag(card), data: { action: "dialog#close", turbo_frame: "_top" } do %>
              <span class="for-screen-reader"><%= card.title %></span>
            <% end %>
          </div>
        </div>
      </div>

      <%= render "cards/stagings/stages", card: card if card.doing? %>
    </div>

    <footer class="card__footer">
      <%= render "cards/display/preview/meta", card: card %>
      <%= render "cards/display/common/background", card: card %>
    </footer>

    <% if card.entropic? %>
      <%= render "cards/display/preview/bubble", card: card %>
    <% end %>
  <% end %>
<% end %>
